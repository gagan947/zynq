<section class="py-5">
      <div class="container-fluid ">
            <div class="row">
                  <div class="col-md-10 mx-auto">
                        <div class="text-center mb-5 position-relative">
                              <h4 class="ct_fs_20 ct_fw_600 mb-2">{{'completeYourProfile' | translate}}</h4>
                              <p class="mb-0">{{'pleaseFill' | translate}}</p>
                              <div class="mb-3 ct_fs_18 status-div"> <span
                                          class="ct_custom_badge_yellow">ONBOARDING</span>
                              </div>
                        </div>
                        <form id="msform" [formGroup]="Form" (ngSubmit)="onSubmit()">
                              <!-- progressbar -->
                              <ul id="ct_form_progressbar">
                                    <li *ngFor="let step of steps; let i = index;" [id]="step.id"
                                          [class.active]="i <= currentStep">
                                          {{ step.label | translate }}
                                    </li>
                              </ul>

                              <fieldset *ngIf="currentStep == 0">
                                    <div class="ct_white_bg ct_p_40 ct_border_clr_e6e6e6 ct_border_radius_15 mb-4">
                                          <h5 class="ct_fs_20 ct_ff_ambit_semibold mb-3">{{'Basic' | translate}}
                                                {{'Clinic' | translate}} {{'Information' | translate}}
                                          </h5>
                                          <div class="form-group mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'Organization' | translate}}
                                                      {{'Number' | translate}}
                                                </label>
                                                <input type="text" class="form-control ct_input"
                                                      placeholder="{{'Enter' | translate}} {{'Organization' | translate}} {{'Number' | translate}}"
                                                      formControlName="org_number">
                                                <span
                                                      *ngIf="Form.controls['org_number'].invalid && Form.controls['org_number'].touched">
                                                      <span *ngIf="Form.controls['org_number'].errors?.['required']"
                                                            class="ct_text_red mt-2">
                                                            {{'Organization' | translate}} {{'Number' | translate}}
                                                            {{'isRequired' | translate}}.
                                                      </span>
                                                </span>
                                          </div>
                                          <div class="form-group mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'Clinic' | translate}}
                                                      {{'Name' | translate}} <span class="ct_red_text">*</span></label>
                                                <input type="text" class="form-control ct_input"
                                                      placeholder="{{'Enter' | translate}} {{'Clinic' | translate}} {{'Name' | translate}}"
                                                      formControlName="clinic_name">
                                                <span
                                                      *ngIf="Form.controls['clinic_name'].invalid && Form.controls['clinic_name'].touched">
                                                      <span *ngIf="Form.controls['clinic_name'].errors?.['required']"
                                                            class="ct_text_red mt-2">
                                                            {{'Clinic' | translate}} {{'Name' | translate | lowercase}}
                                                            {{'isRequired' | translate}}.
                                                      </span>
                                                </span>
                                          </div>
                                          <!-- <div class="form-group mb-4">
                                                <label for="" class="mb-2 ct_text_black">IVO Registration Number
                                                </label>
                                                <input type="text" class="form-control ct_input"
                                                      placeholder="Enter IVO Registration Number"
                                                      formControlName="ivo_registration_number">
                                                <span
                                                      *ngIf="Form.controls['ivo_registration_number'].invalid && Form.controls['ivo_registration_number'].touched">
                                                      <span *ngIf="Form.controls['ivo_registration_number'].errors?.['required']"
                                                            class="ct_text_red mt-2">
                                                            IVO registration number is required.
                                                      </span>
                                                </span>
                                          </div>
                                          <div class="form-group mb-4">
                                                <label for="" class="mb-2 ct_text_black">HSA Id </label>
                                                <input type="text" class="form-control ct_input"
                                                      placeholder="Enter HSA Id" formControlName="hsa_id">
                                                <span
                                                      *ngIf="Form.controls['hsa_id'].invalid && Form.controls['hsa_id'].touched">
                                                      <span *ngIf="Form.controls['hsa_id'].errors?.['required']"
                                                            class="ct_text_red mt-2">
                                                            HSA id is required.
                                                      </span>
                                                </span>
                                          </div> -->
                                          <div class="form-group mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'Description' |
                                                      translate}}<span class="ct_red_text">*</span></label>
                                                <textarea type="text" class="form-control ct_input h-auto" rows="4"
                                                      placeholder="{{'Enter' | translate}} {{'Description' | translate}}"
                                                      formControlName="clinic_description"></textarea>
                                                <span
                                                      *ngIf="Form.controls['clinic_description'].invalid && Form.controls['clinic_description'].touched">
                                                      <span *ngIf="Form.controls['clinic_description'].errors?.['required']"
                                                            class="ct_text_red mt-2">
                                                            {{'Description' | translate}} {{'isRequired' | translate}}.
                                                      </span>
                                                      <span *ngIf="Form.controls['clinic_description'].errors?.['maxlength']"
                                                            class="ct_text_red mt-2">
                                                            {{'desacriptionTooLong' | translate}}
                                                      </span>
                                                </span>
                                          </div>
                                          <div class="form-group mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'Logo' | translate}}</label>
                                                <div class="">
                                                      <div *ngIf="!logoPreview" class="ct_upload_product_main"
                                                            (click)="logoInput.click()">
                                                            <svg width="33" height="33" viewBox="0 0 33 33" fill="none"
                                                                  xmlns="http://www.w3.org/2000/svg">
                                                                  <path d="M5.87174 22.0167C4.26376 20.9403 3.20508 19.1073 3.20508 17.027C3.20508 13.9023 5.59376 11.3354 8.64473 11.0528C9.26883 7.25653 12.5654 4.36035 16.5384 4.36035C20.5114 4.36035 23.808 7.25653 24.4321 11.0528C27.4831 11.3354 29.8717 13.9023 29.8717 17.027C29.8717 19.1073 28.8131 20.9403 27.2051 22.0167M11.2051 21.6937L16.5384 16.3604M16.5384 16.3604L21.8717 21.6937M16.5384 16.3604V28.3604"
                                                                        stroke="#9CA3AF" stroke-width="2.66667"
                                                                        stroke-linecap="round"
                                                                        stroke-linejoin="round" />
                                                            </svg>

                                                            <p class="text-center ct_fs_18 ct_text_op_07 mb-0">
                                                                  {{'UploadYourImage' | translate}}
                                                            </p>
                                                            <small class="text-center d-block ct_text_9CA3AF py-2">PNG,
                                                                  JPG up to
                                                                  5MB</small>
                                                            <label>
                                                                  <div class="ct_browse_btn">
                                                                        <span>{{'browseFile' | translate}}</span>
                                                                  </div>
                                                            </label>
                                                      </div>
                                                      <input type="file" #logoInput class="d-none" accept="image/png"
                                                            formControlName="logo" (change)="onLogoImage($event)">
                                                      <div class="ct_uploaded_img123 position-relative w-100 ct_upload_product_main"
                                                            *ngIf="logoPreview">
                                                            <div class="ct_uploaded_img_w">
                                                                  <img [src]="logoPreview" alt=""
                                                                        style="object-fit: contain;" />
                                                                  <i class="fa-solid fa-xmark"
                                                                        (click)="removeImage()"></i>
                                                            </div>
                                                      </div>
                                                </div>
                                          </div>
                                          <div class="form-group mb-0">
                                                <label for="" class="mb-2">{{'Upload' | translate}}
                                                      {{'Clinic' | translate}} {{'Images' | translate}}</label>
                                                <div class="ct_upload_product_main ct_upload_product_main_180">
                                                      <svg width="33" height="33" viewBox="0 0 33 33" fill="none"
                                                            xmlns="http://www.w3.org/2000/svg">
                                                            <path d="M5.87174 22.0167C4.26376 20.9403 3.20508 19.1073 3.20508 17.027C3.20508 13.9023 5.59376 11.3354 8.64473 11.0528C9.26883 7.25653 12.5654 4.36035 16.5384 4.36035C20.5114 4.36035 23.808 7.25653 24.4321 11.0528C27.4831 11.3354 29.8717 13.9023 29.8717 17.027C29.8717 19.1073 28.8131 20.9403 27.2051 22.0167M11.2051 21.6937L16.5384 16.3604M16.5384 16.3604L21.8717 21.6937M16.5384 16.3604V28.3604"
                                                                  stroke="#9CA3AF" stroke-width="2.66667"
                                                                  stroke-linecap="round" stroke-linejoin="round" />
                                                      </svg>

                                                      <p class="text-center ct_fs_18 ct_text_op_07 mb-0">
                                                            {{'UploadClinicImage' | translate}}
                                                      </p>
                                                      <label for="ct_upload_product">
                                                            <input type="file" name="" id="ct_upload_product"
                                                                  class="d-none" accept="image/*"
                                                                  (change)="onProductImage($event)" multiple>
                                                            <div class="ct_browse_btn">
                                                                  <span>{{'browseFile' | translate}}</span>
                                                            </div>
                                                      </label>
                                                      <!-- after upload image change url to below image -->
                                                      <img src="assets/img/hunting_knee.png" alt=""
                                                            class="ct_uploaded_img d-none">
                                                </div>
                                                <div class="ct_multiple_img_div ct_custom_scroll">
                                                      @for (item of previewProductImages; track $index) {
                                                      <div class="ct_uploaded_img123 position-relative ">
                                                            <div class="ct_uploaded_img_w">
                                                                  <img [src]="item" alt="" />
                                                                  <i class="fa-solid fa-xmark ct_cursor_pointer"
                                                                        (click)="removeProductImage($index, item)"></i>
                                                            </div>
                                                      </div>
                                                      }
                                                </div>
                                                <!-- <span *ngIf="previewProductImages.length == 0 && submitted">
                                                      <span class="ct_text_red mt-2">
                                                            Please upload product image.
                                                      </span>
                                                </span> -->
                                          </div>
                                    </div>

                                    <button type="submit" class="ct_form_next action-button ct_black_btn float-end "
                                          value="Next" [disabled]="loading">
                                          @if(loading){
                                          <div class="spinner-border" role="status">
                                                <span class="sr-only">Loading...</span>
                                          </div>
                                          }@else {
                                          {{'Next' | translate}}
                                          }
                                    </button>
                              </fieldset>
                              <fieldset *ngIf="currentStep == 1">
                                    <div class="ct_white_bg ct_p_40 ct_border_clr_e6e6e6 ct_border_radius_15 mb-4">
                                          <h5 class="ct_fs_20 ct_ff_ambit_semibold mb-3">
                                                {{'LocationContactDetails' | translate}}
                                          </h5>

                                          <div class="row">
                                                <div class="col-md-12">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'streetAddress' |
                                                                  translate}}<span class="ct_red_text">*</span></label>
                                                            <input type="text" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'streetAddress' | translate}}"
                                                                  formControlName="street_address">
                                                            <span
                                                                  *ngIf="Form.controls['street_address'].invalid && Form.controls['street_address'].touched">
                                                                  <span *ngIf="Form.controls['street_address'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'streetAddress' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>
                                                </div>
                                                <div class="col-md-6">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'City' |
                                                                  translate}}<span class="ct_red_text">*</span></label>
                                                            <input type="text" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'City' | translate}}"
                                                                  formControlName="city">
                                                            <span
                                                                  *ngIf="Form.controls['city'].invalid && Form.controls['city'].touched">
                                                                  <span *ngIf="Form.controls['city'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'City' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>
                                                </div>
                                                <!-- <div class="col-md-6">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'State' |
                                                                  translate}}<span class="ct_red_text">*</span></label>
                                                            <input type="text" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'State' | translate}}"
                                                                  formControlName="state">
                                                            <span
                                                                  *ngIf="Form.controls['state'].invalid && Form.controls['state'].touched">
                                                                  <span *ngIf="Form.controls['state'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'State' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>

                                                </div> -->
                                                <div class="col-md-6">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'ZipCode' |
                                                                  translate}}<span class="ct_red_text">*</span></label>
                                                            <input type="text" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'ZipCode' | translate}}"
                                                                  formControlName="zip_code">
                                                            <span
                                                                  *ngIf="Form.controls['zip_code'].invalid && Form.controls['zip_code'].touched">
                                                                  <span *ngIf="Form.controls['zip_code'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'ZipCode' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>
                                                </div>
                                                <div class="col-md-12">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'MapLocatiom' |
                                                                  translate}}<span class="ct_red_text">*</span></label>
                                                            <input type="text" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'MapLocatiom' | translate}}"
                                                                  (input)="searchLocation($event)"
                                                                  [value]="selectedLocation">
                                                            <!-- when user enter location then show this div -->
                                                            <div class="ct_map_location_dropdown"
                                                                  *ngIf="locations.length > 0">
                                                                  <ul>
                                                                        @for (item of locations; track $index) {
                                                                        <li (click)="selectLocation(item.description)">
                                                                              {{item.description}}
                                                                        </li>
                                                                        }
                                                                  </ul>
                                                            </div>
                                                            <span>
                                                                  <span *ngIf="!selectedLocation && submitted"
                                                                        class="ct_text_red mt-2">
                                                                        {{'MapLocatiom' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>
                                                </div>
                                                <div class="col-md-6">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'PhoneNo' |
                                                                  translate}}<span class="ct_red_text">*</span></label>
                                                            <!-- <input type="number" class="form-control ct_input"
                                                                  placeholder="Enter phone number"
                                                                  formControlName="mobile_number"> -->
                                                            <ngx-intl-tel-input
                                                                  [cssClass]="'form-control ct_input w-full'"
                                                                  [enableAutoCountrySelect]="true"
                                                                  [enablePlaceholder]="true" [searchCountryFlag]="false"
                                                                  [searchCountryField]="[SearchCountryField.Iso2, SearchCountryField.Name]"
                                                                  [selectFirstCountry]="false"
                                                                  [onlyCountries]="preferredCountries"
                                                                  [selectedCountryISO]="selectedCountry"
                                                                  [maxLength]="15" [phoneValidation]="true"
                                                                  formControlName="mobile_number"></ngx-intl-tel-input>
                                                            <span
                                                                  *ngIf="Form.controls['mobile_number'].invalid && Form.controls['mobile_number'].touched">
                                                                  <span *ngIf="Form.controls['mobile_number'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'PhoneNo' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                                  <span *ngIf="Form.controls['mobile_number'].errors?.['validatePhoneNumber']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'Invalid' | translate}}
                                                                        {{'PhoneNo' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>
                                                </div>
                                                <div class="col-md-6">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'Email' |
                                                                  translate}}
                                                                  {{'Address' | translate}}<span
                                                                        class="ct_red_text">*</span></label>
                                                            <input type="email" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'Email' | translate}} {{'Address' | translate}}"
                                                                  formControlName="email" readonly>
                                                            <span
                                                                  *ngIf="Form.controls['email'].invalid && Form.controls['email'].touched">
                                                                  <span *ngIf="Form.controls['email'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'Email' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                                  <span *ngIf="Form.controls['email'].errors?.['email'] && !Form.controls['email'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'Invalid' | translate}}
                                                                        {{'Email' | translate}}.</span>
                                                            </span>
                                                      </div>
                                                </div>
                                                <div class="col-md-12">
                                                      <div class="form-group mb-4">
                                                            <label for="" class="mb-2 ct_text_black">{{'WebsiteURL' |
                                                                  translate}}</label>
                                                            <input type="text" class="form-control ct_input"
                                                                  placeholder="{{'Enter' | translate}} {{'WebsiteURL' | translate}}"
                                                                  formControlName="website_url">
                                                            <span
                                                                  *ngIf="Form.controls['website_url'].invalid && Form.controls['website_url'].touched">
                                                                  <span *ngIf="Form.controls['website_url'].errors?.['required']"
                                                                        class="ct_text_red mt-2">
                                                                        {{'WebsiteURL' | translate}}
                                                                        {{'isRequired' | translate}}.
                                                                  </span>
                                                            </span>
                                                      </div>
                                                </div>
                                          </div>

                                    </div>
                                    <button type="button" name="next"
                                          class="ct_form_next action-button  ct_black_btn float-end mx-1 " value="Next"
                                          (click)="nextStep()" [disabled]="loading">
                                          @if(loading){
                                          <div class="spinner-border" role="status">
                                                <span class="sr-only">Loading...</span>
                                          </div>
                                          }@else {
                                          {{'Next' | translate}}
                                          }
                                    </button>
                                    <button type="button" name="previous"
                                          class="previous action-button-previous ct_outline_btn mx-1 float-end"
                                          value="Previous" (click)="previousStep()">{{'Previous' | translate}}</button>
                              </fieldset>

                              <fieldset *ngIf="currentStep == 2">
                                    <div class=" ct_white_bg ct_p_40 ct_border_clr_e6e6e6 ct_border_radius_15 mb-4">
                                          <h5 class="ct_fs_20 ct_ff_ambit_semibold mb-3">
                                                {{'ServiceExpertise' | translate}}
                                          </h5>
                                          <div class="mb-4">
                                                <div class="d-flex align-items-center justify-content-between">
                                                      <label for="" class="mb-2 ct_text_black">{{'TreatmentsProvided' |
                                                            translate}}<span class="ct_red_text">*</span></label>
                                                      <input type="text" class="form-control w-25 mb-2"
                                                            [placeholder]="('Search' | translate) + ' ' + ('Treatment' | translate)"
                                                            (input)="onTreatmentSearch($event)" #searchInput>
                                                </div>
                                                <div class="table-responsive" style="max-height: 50vh;">
                                                      <table class="table ct_custom_table">
                                                            <thead>
                                                                  <tr>
                                                                        <th class="border p-2"></th>
                                                                        <th class="border p-2">{{'Treatment' |
                                                                              translate}}</th>
                                                                        <th class="border p-2">{{'Price' | translate}}
                                                                              <span class="ct_fs_12 text-muted">({{'includedVat'
                                                                                    |
                                                                                    translate}})</span>
                                                                        </th>
                                                                        <th class="border p-2"></th>
                                                                  </tr>
                                                            </thead>
                                                            <tbody>
                                                                  @for (t of treatmentsArray.controls; track $index) {
                                                                  <tr>
                                                                        <td class="border p-2 text-center">
                                                                              <div
                                                                                    class="text-start form-check ct_custom_check mt-0">
                                                                                    <input type="checkbox"
                                                                                          [id]="'treatment-checkbox-'+$index"
                                                                                          class="form-check-input ct_custom_check mt-0"
                                                                                          [formControl]="getControl(t, 'selected')"
                                                                                          (change)="onTreatmentSelectChange($index)"
                                                                                          [checked]="t.get('selected')?.value"
                                                                                          [attr.aria-labelledby]="'treatment-checkbox-'+$index" />
                                                                              </div>
                                                                        </td>
                                                                        <td class="border p-2"><label
                                                                                    [attr.for]="'treatment-checkbox-'+$index"
                                                                                    class="ms-2">
                                                                                    {{ t.get('name')?.value }}
                                                                              </label></td>
                                                                        <td class="border p-2" style="width: 200px;">
                                                                              @if(t.get('selected')?.value &&
                                                                              subTreatments($index).controls.length ==
                                                                              0){
                                                                              <div>
                                                                                    <input type="number"
                                                                                          class="form-control"
                                                                                          placeholder="{{'Enter' | translate}} {{'Price' | translate}}"
                                                                                          [formControl]="getControl(t, 'price')" />
                                                                                    <small class="text-danger"
                                                                                          *ngIf="t.get('price')?.touched && t.get('price')?.hasError('required')">
                                                                                          {{'Price' | translate}}
                                                                                          {{'isRequired' | translate}}
                                                                                    </small>
                                                                                    <small class="text-danger"
                                                                                          *ngIf="t.get('price')?.touched && t.get('price')?.hasError('invalidPrice')">
                                                                                          {{'Price' | translate}}
                                                                                          {{'mustBeGreaterThanOrEqualTo'
                                                                                          |
                                                                                          translate}} 3.
                                                                                    </small>
                                                                              </div>
                                                                              }@else {
                                                                              <span>{{t.get('price')?.value > 0 ?
                                                                                    t.get('price')?.value : ''}}</span>
                                                                              }
                                                                        </td>
                                                                        <td class="border p-2 align-middle text-center"
                                                                              style="width:40px">
                                                                              @if(subTreatments($index).controls.length
                                                                              > 0){
                                                                              <a href="javascript:void(0)"
                                                                                    class="text-dark"
                                                                                    data-bs-toggle="collapse"
                                                                                    [attr.data-bs-target]="'#collapseRecommendedSubTreatments'+$index"
                                                                                    [attr.aria-expanded]="'false'"
                                                                                    [attr.aria-controls]="'collapseRecommendedSubTreatments'+$index"
                                                                                    (click)="toggleRecommendedCollapse(recommendedCollapseStates, $index)">
                                                                                    <i class="fa"
                                                                                          [ngClass]="{
                                                                                                                                                                  'fa-chevron-down': !(recommendedCollapseStates[ $index ]),
                                                                                                                                                                  'fa-chevron-up': recommendedCollapseStates[ $index ]
                                                                                                                                                            }"></i>
                                                                              </a>
                                                                              }
                                                                        </td>
                                                                  </tr>
                                                                  @if(subTreatments($index).controls.length
                                                                  > 0 && recommendedCollapseStates[$index] === true){
                                                                  <tr [id]="'collapseRecommendedSubTreatments'+$index">
                                                                        <td colspan="4" class="p-0 border-0">
                                                                              <div class=" p-3"
                                                                                    style="background-color: #f5f5f5;">
                                                                                    <table class="table  mb-0">
                                                                                          <thead>
                                                                                                <tr>
                                                                                                      <th
                                                                                                            class="border p-2">
                                                                                                      </th>
                                                                                                      <th
                                                                                                            class="border p-2">
                                                                                                            {{'SubTreatment'
                                                                                                            |
                                                                                                            translate}}
                                                                                                      </th>
                                                                                                      <th
                                                                                                            class="border p-2">
                                                                                                            {{'Price' |
                                                                                                            translate}}
                                                                                                            <span
                                                                                                                  class="ct_fs_12 text-muted">({{'includedVat'
                                                                                                                  |
                                                                                                                  translate}})</span>
                                                                                                      </th>
                                                                                                </tr>
                                                                                          </thead>
                                                                                          <tbody>
                                                                                                <tr
                                                                                                      *ngFor="let c of subTreatments($index).controls; let j = index">
                                                                                                      <td class="border p-2 text-center"
                                                                                                            style="width: 40px;">
                                                                                                            <div
                                                                                                                  class=" form-check ">
                                                                                                                  <input type="checkbox"
                                                                                                                        [id]="'sub-treatment-checkbox-'+$index+'-'+j"
                                                                                                                        class="form-check-input ct_custom_check mt-0 "
                                                                                                                        [formControl]="getChildControl($index, j, 'selected')"
                                                                                                                        (change)="onChildSelectChange($index, j)"
                                                                                                                        [checked]="c.get('selected')?.value"
                                                                                                                        [attr.aria-labelledby]="'sub-treatment-checkbox-'+$index+'-'+j" />
                                                                                                            </div>
                                                                                                      </td>
                                                                                                      <td
                                                                                                            class="border p-2">
                                                                                                            <label [attr.for]="'sub-treatment-checkbox-'+$index+'-'+j"
                                                                                                                  class="ms-2">
                                                                                                                  {{
                                                                                                                  c.get('name')?.value
                                                                                                                  }}
                                                                                                            </label>
                                                                                                      </td>
                                                                                                      <td class="border p-2"
                                                                                                            style="width: 200px;">
                                                                                                            @if(c.get('selected')?.value){
                                                                                                            <div>
                                                                                                                  <input type="number"
                                                                                                                        class="form-control"
                                                                                                                        placeholder="{{'Enter' | translate}} {{'Price' | translate}}"
                                                                                                                        [formControl]="getChildControl($index, j, 'price')" />

                                                                                                                  <small class="text-danger"
                                                                                                                        *ngIf="c.get('price')?.touched && c.get('price')?.hasError('required')">
                                                                                                                        {{'Price'
                                                                                                                        |
                                                                                                                        translate}}
                                                                                                                        {{'isRequired'
                                                                                                                        |
                                                                                                                        translate}}
                                                                                                                  </small>
                                                                                                                  <small class="text-danger"
                                                                                                                        *ngIf="c.get('price')?.touched && c.get('price')?.hasError('invalidPrice')">
                                                                                                                        {{'Price'
                                                                                                                        |
                                                                                                                        translate}}
                                                                                                                        {{'mustBeGreaterThanOrEqualTo'
                                                                                                                        |
                                                                                                                        translate}}
                                                                                                                        3.
                                                                                                                  </small>
                                                                                                            </div>
                                                                                                            }
                                                                                                      </td>
                                                                                                </tr>
                                                                                          </tbody>
                                                                                    </table>
                                                                              </div>
                                                                        </td>
                                                                  </tr>
                                                                  }
                                                                  }
                                                            </tbody>
                                                      </table>
                                                </div>
                                          </div>
                                          <div class="mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'Devices' |
                                                      translate}}</label>
                                                <nz-select nzMode="multiple"
                                                      nzPlaceHolder="{{'Select' | translate}} {{'Devices' | translate}}"
                                                      class="form-control ct_input h-auto" formControlName="devices"
                                                      nzNotFoundContent="No Device Found">
                                                      @for (item of devices; track item) {
                                                      <nz-option [nzLabel]="item.device_name"
                                                            [nzValue]="item.id"></nz-option>
                                                      }
                                                </nz-select>
                                                <span class="ct_text_red mt-2"
                                                      *ngIf="Form.get('devices')?.invalid && Form.get('devices')?.touched">
                                                      {{'pleaseAddAtleast' | translate}} {{'Devices' | translate}}.
                                                </span>
                                          </div>
                                          <div class="mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'SkinTypeExpertise' |
                                                      translate}}
                                                </label>
                                                <nz-select nzMode="multiple"
                                                      nzPlaceHolder="{{'Select' | translate}} {{'SkinType' | translate}}"
                                                      class="form-control ct_input h-auto" formControlName="skin_types"
                                                      nzNotFoundContent="No Skin Types Found">
                                                      @for (item of skintypes; track item) {
                                                      <nz-option [nzLabel]="item.name"
                                                            [nzValue]="item.skin_type_id"></nz-option>
                                                      }
                                                </nz-select>
                                                <span class="ct_text_red mt-2"
                                                      *ngIf="Form.get('skin_types')?.invalid && Form.get('skin_types')?.touched">
                                                      {{'pleaseAddAtleast' | translate}} {{'SkinType' | translate}}.
                                                </span>
                                          </div>

                                          <div class="mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'SurgeriesProvided' |
                                                      translate}}</label>
                                                <nz-select nzMode="multiple"
                                                      nzPlaceHolder="{{'Select' | translate}} {{'Surgeries' | translate}}"
                                                      class="form-control ct_input h-auto" formControlName="surgeries"
                                                      nzNotFoundContent="No Severity Found">
                                                      @for (item of surgeries; track item) {
                                                      <nz-option [nzLabel]="item.english"
                                                            [nzValue]="item.surgery_id"></nz-option>
                                                      }
                                                </nz-select>
                                                <span class="ct_text_red mt-2"
                                                      *ngIf="Form.get('surgeries')?.invalid && Form.get('surgeries')?.touched">
                                                      {{'pleaseAddAtleast' | translate}} {{'Surgery' | translate}}.
                                                </span>
                                          </div>
                                          <!-- <div class="mb-4">
                                                <label for="" class="mb-2 ct_text_black">{{'Devices' | translate}}<span
                                                            class="ct_red_text">*</span></label>
                                                <nz-select nzMode="multiple"
                                                      nzPlaceHolder="{{'Select' | translate}} {{'Devices' | translate}}"
                                                      class="form-control ct_input h-auto" formControlName="devices"
                                                      nzNotFoundContent="No Device Found">
                                                      @for (item of devices; track item) {
                                                      <nz-option [nzLabel]="item.device"
                                                            [nzValue]="item.aesthetic_device_id"></nz-option>
                                                      }
                                                </nz-select>
                                                <span class="ct_text_red mt-2"
                                                      *ngIf="Form.get('devices')?.invalid && Form.get('devices')?.touched">
                                                      {{'pleaseAddAtleast' | translate}} {{'Device' | translate}}.
                                                </span>
                                          </div> -->
                                    </div>

                                    <button type="submit" name="next"
                                          class="ct_black_btn float-end mx-1 ct_border_radius_10 " [disabled]="loading">
                                          @if(loading){
                                          <div class="spinner-border" role="status">
                                                <span class="sr-only">Loading...</span>
                                          </div>
                                          }@else {
                                          {{'Submit' | translate}}
                                          }
                                    </button>
                                    <button type="button" name="previous"
                                          class="previous action-button-previous ct_outline_btn mx-1 float-end"
                                          value="Previous" (click)="previousStep()">{{'Previous' | translate}}</button>
                              </fieldset>
                              <fieldset *ngIf="currentStep == 3">
                                    <div class="ct_white_bg ct_p_20 ct_border_clr_e6e6e6 ct_border_radius_15 mb-4">

                                          <h5 class="ct_fs_20 ct_ff_ambit_semibold mb-3">
                                                {{'OperationHours' | translate}}
                                          </h5>
                                          <div class="py-3 border-bottom d-flex align-items-center gap-3 gap-md-5">
                                                <label class=" d-flex align-items-center gap-2">
                                                      <input type="radio"
                                                            class="form-check-input ct_custom_check mt-0 me-1"
                                                            formControlName="sameForAllDays" [value]="true" />
                                                      <span>{{'sameForAllDays' | translate}}</span>
                                                </label>
                                                <label class=" d-flex align-items-center gap-2">
                                                      <input type="radio"
                                                            class="form-check-input ct_custom_check mt-0 me-1"
                                                            formControlName="sameForAllDays" [value]="false" />
                                                      <span>{{'Customize' | translate}}</span>
                                                </label>
                                          </div>
                                          <div formArrayName="clinic_timing">
                                                <!-- If SAME FOR ALL DAYS is selected, show only one day (index 0) -->
                                                <div *ngIf="Form.get('sameForAllDays')?.value === true">
                                                      <div [formGroupName]="0" class="py-3 border-bottom">
                                                            <h6 class="mb-2">{{ daysOfWeek[0] }} (applies to all
                                                                  days)
                                                            </h6>
                                                            <ng-container>
                                                                  <div formArrayName="sessions">
                                                                        <div *ngFor="let session of getSessions(0).controls; let j = index"
                                                                              [formGroupName]="j">
                                                                              <div class="ct_grid_40_40_20 mb-3">
                                                                                    <div>
                                                                                          <div class="form-group">
                                                                                                <label for=""
                                                                                                      class="mb-2 ct_text_black">
                                                                                                      {{'StartTime'
                                                                                                      |
                                                                                                      translate}}
                                                                                                      <span
                                                                                                            class="ct_red_text">*</span></label>
                                                                                                <input type="time"
                                                                                                      class="form-control ct_input"
                                                                                                      formControlName="start_time" />
                                                                                          </div>
                                                                                          <div *ngIf="session.get('start_time')?.touched && session.get('start_time')?.hasError('required')"
                                                                                                class="ct_text_red">
                                                                                                {{'StartTime' |
                                                                                                translate}}
                                                                                                {{'isRequired' |
                                                                                                translate}}.
                                                                                          </div>
                                                                                    </div>
                                                                                    <div>
                                                                                          <div class="form-group">
                                                                                                <label for=""
                                                                                                      class="mb-2 ct_text_black">
                                                                                                      {{'EndTime'
                                                                                                      |
                                                                                                      translate}}
                                                                                                      <span
                                                                                                            class="ct_red_text">*</span></label>
                                                                                                <input type="time"
                                                                                                      class="form-control ct_input"
                                                                                                      formControlName="end_time" />
                                                                                          </div>
                                                                                          <div *ngIf="session.get('end_time')?.touched && session.get('end_time')?.hasError('required')"
                                                                                                class="ct_text_red">
                                                                                                {{'EndTime' |
                                                                                                translate}}
                                                                                                {{'isRequired' |
                                                                                                translate}}.
                                                                                          </div>
                                                                                    </div>
                                                                              </div>
                                                                        </div>
                                                                  </div>
                                                            </ng-container>
                                                      </div>
                                                </div>

                                                <!-- If CUSTOMIZE is selected, show all 7 days -->
                                                <div *ngIf="Form.get('sameForAllDays')?.value === false">
                                                      <div *ngFor="let dayCtrl of clinic_timing.controls; let i = index"
                                                            [formGroupName]="i" class="py-3 border-bottom">
                                                            <div class="mb-2">
                                                                  <label>
                                                                        <input type="checkbox" formControlName="active"
                                                                              class="form-check-input ct_custom_check mt-0 me-2" />
                                                                        {{ daysOfWeek[i] }}
                                                                  </label>
                                                            </div>
                                                            <div *ngIf="dayCtrl.get('active')?.value">
                                                                  <div formArrayName="sessions">
                                                                        <div *ngFor="let session of getSessions(i).controls; let j = index"
                                                                              [formGroupName]="j" class="ml-4 mb-2">
                                                                              <div class="ct_grid_40_40_20 mb-3">
                                                                                    <div>
                                                                                          <div class="form-group">
                                                                                                <label for=""
                                                                                                      class="mb-2 ct_text_black">
                                                                                                      {{'StartTime'
                                                                                                      |
                                                                                                      translate}}
                                                                                                      <span
                                                                                                            class="ct_red_text">*</span></label>
                                                                                                <input type="time"
                                                                                                      class="form-control ct_input"
                                                                                                      formControlName="start_time" />
                                                                                          </div>
                                                                                          <div *ngIf="session.get('start_time')?.touched && session.get('start_time')?.hasError('required')"
                                                                                                class="ct_text_red">
                                                                                                {{'StartTime' |
                                                                                                translate}}
                                                                                                {{'isRequired' |
                                                                                                translate}}.
                                                                                          </div>
                                                                                    </div>
                                                                                    <div>
                                                                                          <div class="form-group">
                                                                                                <label for=""
                                                                                                      class="mb-2 ct_text_black">
                                                                                                      {{'EndTime'
                                                                                                      |
                                                                                                      translate}}
                                                                                                      <span
                                                                                                            class="ct_red_text">*</span></label>
                                                                                                <input type="time"
                                                                                                      class="form-control ct_input"
                                                                                                      formControlName="end_time" />
                                                                                          </div>
                                                                                          <div *ngIf="session.get('end_time')?.touched && session.get('end_time')?.hasError('required')"
                                                                                                class="ct_text_red">
                                                                                                {{'EndTime' |
                                                                                                translate}}
                                                                                                {{'isRequired' |
                                                                                                translate}}.
                                                                                          </div>
                                                                                    </div>
                                                                              </div>
                                                                        </div>
                                                                  </div>
                                                            </div>
                                                      </div>
                                                </div>
                                          </div>

                                          <div class="my-4">
                                                <label for="" class="mb-2 ct_text_black">
                                                      {{'SessionDuration'
                                                      | translate}}
                                                      <span class="ct_red_text">*</span></label>
                                                <nz-select class="form-control ct_input" formControlName="slot_time"
                                                      nzPlaceHolder="{{'Select' | translate}} {{'SessionDuration' | translate}}">
                                                      <nz-option *ngFor="let duration of sessionDuration"
                                                            [nzValue]="duration"
                                                            [nzLabel]="duration + ' Mins'"></nz-option>
                                                </nz-select>
                                                <div *ngIf="Form.get('slot_time')?.touched && Form.get('slot_time')?.hasError('required')"
                                                      class="ct_text_red">
                                                      {{'SessionDuration' |
                                                      translate}}
                                                      {{'isRequired' |
                                                      translate}}.
                                                </div>
                                          </div>
                                    </div>

                                    <button type="submit" name="next"
                                          class="ct_form_next action-button ct_black_btn float-end mx-1 " value="Next"
                                          [disabled]="loading">
                                          @if(loading){
                                          <div class="spinner-border" role="status">
                                                <span class="sr-only">Loading...</span>
                                          </div>
                                          }@else {
                                          {{'Next' | translate}}
                                          }
                                    </button>
                                    <button type="button" name="previous"
                                          class="previous action-button-previous ct_outline_btn mx-1 float-end"
                                          value="Previous" (click)="previousStep()">{{'Previous' |
                                          translate}}</button>
                              </fieldset>
                        </form>
                        <fieldset *ngIf="currentStep == 4">
                              <div class="ct_white_bg ct_border_radius_10 ct_border_clr_D2D5DB ct_py_28_px_20 mt-4">
                                    <h4 class="mb-3 ct_fs_20 ct_fw_600">Expert {{'Email' | translate}}</h4>
                                    <div>
                                          <ul
                                                class="d-flex align-items-center gap-3 flex-wrap  ct_para_scroll ct_custom_scroll ct_pe_30">
                                                @for (item of selectedDrEmail; track
                                                $index) {
                                                <li>
                                                      <button type="button" class="ct_select_badge">{{item}}
                                                            <span (click)="removeDrEmail($index)"><i
                                                                        class="fa-solid fa-xmark"></i></span></button>
                                                </li>
                                                }
                                          </ul>
                                          <div class="position-relative mt-4">
                                                <input type="text" class="form-control ct_input ct_pe_122"
                                                      placeholder="{{'TypeToAdd' | translate}} {{'Email' | translate}}..."
                                                      #drEmail>
                                                <button type="button" class="ct_black_btn ct_btn_position_right"
                                                      (click)="addDrEmail(drEmail.value)">{{'Add' | translate}}</button>
                                          </div>
                                    </div>
                              </div>
                              <button type="button" name="next" (click)="inviteDr()"
                                    class="ct_black_btn float-end mx-1 mt-4 ct_border_radius_10">{{'Invite' |
                                    translate}}</button>
                              <button type="button" name="previous"
                                    class="previous action-button-previous ct_outline_btn mx-1  mt-4  float-end"
                                    value="Previous" (click)="previousStep()">{{'Previous' | translate}}</button>
                        </fieldset>
                  </div>
            </div>
      </div>
</section>

<div class="modal fade modal-lg" id="ct_feedback_detail_modal" tabindex="-1"
      aria-labelledby="ct_feedback_detail_modalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                  <div class="modal-body">
                        <image-cropper [imageChangedEvent]="imageChangedEvent" [maintainAspectRatio]="true"
                              [aspectRatio]="38 / 27" [resizeToWidth]="190" [resizeToHeight]="135" format="png"
                              (imageCropped)="imageCropped($event)">
                        </image-cropper>
                  </div>
                  <div class="modal-footer">
                        <button type="button" class="ct_outline_btn" data-bs-dismiss="modal" #closeBtn>{{'Cancel' |
                              translate}}</button>
                        <button type="button" class="ct_black_btn" (click)="onDone()">{{'Done' | translate}}</button>
                  </div>
            </div>
      </div>
</div>