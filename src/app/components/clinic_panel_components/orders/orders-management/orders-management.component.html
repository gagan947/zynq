<div class="ct_px_30 mt-4 pb-4">
      <div class="container-fluid">
            <div class="row">
                  <div class="col-md-12">
                        <div class="ct_white_bg ct_border_radius_10 ct_border_clr_D2D5DB ct_p_20 ">
                              <div class="d-flex align-items-center justify-content-between">
                                    <div>
                                          <h4 class="ct_fs_22 ct_fw_600 mb-2 ct_text_black">Order Management</h4>
                                          <p class="mb-0">Track and Manage All Clinic Product Orders</p>
                                    </div>
                              </div>
                              <div
                                    class="d-flex align-items-center gap-3 justify-content-between mt-4 ct_flex_col_1199">
                                    <div class="d-flex align-items-center gap-3 ct_flex_col_767 ct_w_100_767">
                                          <div class="form-group position-relative ct_w_100_767">
                                                <input type="text" class="form-control ct_input ct_input_pe_40"
                                                      placeholder="Search" #search (input)="searchFilter($event)">
                                                <i class="fa-solid fa-search ct_show_eye"></i>
                                          </div>
                                          <!-- <div class="d-flex align-items-center gap-3 ct_flex_col_767 ct_w_100_767">
                                                <span class="ct_white_nowrap">Filter by:</span>
                                                <div class="form-group position-relative ct_w_100_767">
                                                      <input type="date" class="form-control ct_input"
                                                            (change)="filterByDate($event)" #date>
                                                </div>
                                          </div> -->
                                          <div class="d-flex align-items-center gap-3 ct_flex_col_767 ct_w_100_767">
                                                <span class="ct_white_nowrap">Filter by:</span>
                                                <div class="form-group position-relative ct_w_100_767">
                                                      <select class="form-control ct_input"
                                                            (change)="filterByStatus($event)">
                                                            <option value="">Status</option>
                                                            <option value="PENDING">Pending</option>
                                                            <option value="SHIPPED">Shipped</option>
                                                            <option value="DELIVERED">Delivered</option>
                                                      </select>
                                                </div>
                                          </div>
                                    </div>
                                    <button
                                          class="ct_form_next action-button ct_black_btn float-end mx-1 ct_outline_btn"
                                          (click)="exportTableToCSV()">Export CSV</button>
                              </div>
                        </div>
                        <div class="table-responsive mt-4 ct_custom_table">
                              <table class="table " id="myTable">
                                    <thead>
                                          <tr>
                                                <th>S.No</th>
                                                <th>Order ID</th>
                                                <th>User Name</th>
                                                <!-- <th>Clinic name</th> -->
                                                <th>Product(s)</th>
                                                <th>Total Amount</th>
                                                <th>Order Date</th>
                                                <th>Delivery Status</th>
                                                <th>Payment Status</th>
                                                <th>Action</th>
                                          </tr>
                                    </thead>
                                    <tbody>
                                          @if(ordersList.length == 0){
                                          <tr>
                                                <td colspan="9" class="text-center">No data found</td>
                                          </tr>
                                          }
                                          @for (item of ordersList; track $index) {
                                          <tr>
                                                <td>{{$index + 1}}</td>
                                                <td>ZYNQ-{{item.purchase_id}}</td>
                                                <td class="">{{item.user.name}}</td>
                                                <!-- <td>{{item.clinic.clinic_name}}</td> -->
                                                <td>
                                                      {{item.products.length}}
                                                </td>
                                                <td>
                                                      {{item.total_price | currency:'SEK '}}
                                                </td>
                                                <td>
                                                      {{item.purchase_date | date:'dd-MM-yyyy - HH:mm'}}
                                                </td>
                                                <td>
                                                      <span [style.color]="getTextColor(item.shipment_status)"
                                                            [ngStyle]="{'background-color': getBgColor(item.shipment_status)}"
                                                            class="p-2 rounded ">
                                                            {{ item.shipment_status | titlecase }}
                                                      </span>
                                                </td>
                                                <td>
                                                      <span class="ct_green_text">
                                                            Paid
                                                      </span>
                                                </td>
                                                <td>
                                                      <div class="d-flex align-items-center gap-3">
                                                            <a (click)="editOrder(item)" class="ct_green_text"
                                                                  data-bs-toggle="modal"
                                                                  data-bs-target="#ct_feedback_detail_modal"><i
                                                                        class="fa-solid fa-pen-to-square"></i></a>
                                                            <a (click)="viewOrder(item)" class="ct_blue_text"><i
                                                                        class="fa-regular fa-eye"></i></a>
                                                      </div>
                                                </td>
                                          </tr>
                                          }
                                    </tbody>
                              </table>
                        </div>
                  </div>
            </div>
      </div>
</div>


<!-- Modal -->
<div class="modal fade" id="ct_feedback_detail_modal" tabindex="-1" aria-labelledby="ct_feedback_detail_modalLabel"
      aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                  <div class="modal-header border-0">
                        <h5 class="modal-title" id="ct_feedback_detail_modalLabel">Change Status</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body pb-5">
                        <div class="form-group">
                              <label for="" class="mb-2">Delivery Status</label>
                              <select class="form-control ct_input" [(ngModel)]="shipmentStatus"
                                    [ngModelOptions]="{standalone: true}">
                                    <option value="PENDING"> Pending</option>
                                    <option value="SHIPPED"> Shipped </option>
                                    <option value="DELIVERED"> Delivered</option>
                              </select>
                        </div>
                        <div class="d-flex align-items-center gap-3 mt-4 justify-content-center">
                              <button data-bs-dismiss="modal" type="button" aria-label="Close"
                                    class="ct_outline_btn px-5 py-2 w-100 " #closeButton>Cancel</button>
                              <button class="ct_black_btn px-5 py-2 w-100 " (click)="updateShipmentStatus()"
                                    [disabled]="loading">
                                    @if(loading){
                                    <div class="spinner-border" role="status">
                                          <span class="sr-only">Loading...</span>
                                    </div>
                                    }@else {
                                    Update
                                    }
                              </button>
                        </div>
                  </div>

            </div>
      </div>
</div>